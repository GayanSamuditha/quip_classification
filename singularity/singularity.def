BootStrap: docker
From: tensorflow/tensorflow:1.13.1-gpu-py3

%post
 	apt-get -y update && \
	apt-get -y install python3-pip openslide-tools wget git && \
	pip install openslide-python scikit-image pymongo 
	export BASE_DIR="/root/quip_classification/u24_lymphocyte"
	cd /root && \
	git clone -b develop https://github.com/SBU-BMI/quip_classification && \
	cd /root/quip_classification/u24_lymphocyte/prediction/NNFramework_TF_models && \
	wget -v -O models.zip -L \
		https://stonybrookmedicine.box.com/shared/static/bl15zu4lwb9cc7ltul15aa8kyrn7kh2d.zip >/dev/null 2>&1 && \
    unzip -o models.zip && rm -f models.zip && \
	chmod 0755 /root/quip_classification/u24_lymphocyte/scripts/*

%environment
	export BASE_DIR="/root/quip_classification/u24_lymphocyte"
	export PATH="/usr/local/bin:./":$PATH

%runscript
	cd ${BASE_DIR}/scripts
	/bin/bash "$@"
